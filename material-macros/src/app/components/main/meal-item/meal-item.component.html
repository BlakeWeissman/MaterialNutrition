<!-- {{item | json}} -->
<mat-card class="mat-elevation-z0">
    <mat-icon cdkDragHandle>drag_handle</mat-icon>
    <div *ngIf="userMealItems[item.type][item.key]; let selectedItem">
        <!-- <h2 class="mat-h2">{{userMealItem.label}}</h2> -->
        <mat-form-field appearance="outline" floatLabel="always">
            <mat-label>Food</mat-label>
            <!--TODO: Force select dropdown to always start with first item on top due to search bar-->
            <mat-select placeholder="Select food" [(ngModel)]="item.key">
                <div id="search">
                    <mat-icon>
                        search
                    </mat-icon>
                    <input matInput placeholder="Search">
                </div>
                <ng-container *ngFor="let mealItemCategory of (userMealItems | objectValues)">
                    <mat-option [value]="mealItemKey" *ngFor="let mealItemKey of (mealItemCategory | objectKeys)">
                        {{mealItemCategory[mealItemKey].label}}
                    </mat-option>
                </ng-container>
            </mat-select>
        </mat-form-field>
        <table class="mat-h4">
            <tr>
                <th>Calories</th>
                <th>Fat (g)</th>
                <th>Carbs (g)</th>
                <th>Protein (g)</th>
                <th>Total Amount ({{selectedItem.servingTypes[item.units].unit}})</th>
            </tr>
            <tr>
                <td>{{selectedItem.calories}}</td>
                <td>{{selectedItem.fat}}</td>
                <td>{{selectedItem.carbs}}</td>
                <td>{{selectedItem.protien}}</td>
                <td>{{item.servings * selectedItem.servingTypes[item.units].servingSize}}</td>
            </tr>
        </table> 
        <div>   
            <mat-form-field appearance="standard">
                <mat-label>Servings</mat-label>
                <input matInput [(ngModel)]="item.servings">
            </mat-form-field>
            <mat-form-field appearance="standard">
                <mat-label>Units</mat-label>
                <mat-select [(ngModel)]="item.units">
                    <mat-option *ngFor="let servingTypeKey of (selectedItem.servingTypes | objectKeys)" [value]="servingTypeKey">
                        <ng-container *ngIf="selectedItem.servingTypes[servingTypeKey]; let servingType">
                            {{servingType.label}} ({{servingType.unit}})
                        </ng-container>
                    </mat-option>
                </mat-select >
            </mat-form-field>
        </div>
    </div>
</mat-card>